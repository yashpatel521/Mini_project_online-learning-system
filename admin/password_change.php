
<?php
    $site = 'data:image/png;base64,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';
    require_once("include/config.php");
    $_SESSION['msg'] = "";
    $_SESSION['set'] = "";
    if(isset($_GET['auth']))
    {
            
            $token = $_GET['auth'];
            $query=$con->prepare("SELECT * FROM admin WHERE auth = '$token' ");
            $query->execute();

            $no=$query->rowCount();  
            if($no==1)
                {
                    if(isset($_POST['update']))
                    {

                        $pw = hash("sha512", $_POST['password']);
                        $cpw = hash("sha512", $_POST['password2']);
                        if($pw === $cpw)
                        {
                            $up_query=$con->prepare("UPDATE admin SET password = '$pw' where auth = '$token' ");
                            $up_query->execute();
                            if($up_query){
                                $_SESSION['set'] = "password update succefully ";
                                // header('location:signlog.php');
                            }
                            else{
                                $_SESSION['msg'] = "Something worng try again";

                            }
                        }
                        else{
                            $_SESSION['msg'] = "Password Doesn't match";
                        }
                    }
                    
                }
            else
            {
                header('location:login.php');
            }
    }
    else
    {

        header('location:login.php');
    }


?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>

 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<style>
    .form-gap {
    padding-top: 70px;
}
</style>
<body>

 <div class="form-gap"></div>
<div class="container">
	<div class="row">
		<div class="col-md-4 col-md-offset-4">
            <div class="panel panel-default">
              <div class="panel-body">
                <div class="text-center">
                  <h3><i class="fa fa-key fa-4x"></i></h3>
                  <h2 class="text-center">Change Password?</h2>
                  <p>You can Create your new password here.</p>
                  <div class="panel-body">
                  <h4 style="text-align:center;color:green;">
            <?php  
                if(isset($_SESSION['set'])){
                    echo $_SESSION['set'];
                }
                else{
                   $_SESSION['set'] = "";
                }
            ?>
        </h4>
                    <form id="register-form" class="form" method="post">
                       
                        <div class="form-group">
                            <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-key color-blue"></i></span>
                            <input  name="password" placeholder="Create New Password" class="form-control"  type="password">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-key color-blue"></i></span>
                            <input  name="password2" placeholder="Confirm Password" class="form-control"  type="password">
                            </div>
                        </div>
                        <h4 style="text-align:center;color:red;">
            <?php  
                if(isset($_SESSION['msg'])){
                    echo $_SESSION['msg'];
                }
                else{
                    $_SESSION['msg'] = "";
                }
            ?>
            </h4>
                       
                        <div class="form-group">
                            <input  class="btn btn-lg btn-primary btn-block" value="Reset Password" type="submit" name="update">
                        </div>
                    </form>
    
                  </div>
                </div>
              </div>
            </div>
          </div>
	</div>
</div>
</body>
</html>